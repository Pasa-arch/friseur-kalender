<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<title>Friseur Kalender</title>

<!-- FullCalendar -->
<link href="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.11/index.global.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.11/index.global.min.js"></script>

<style>
body {
  font-family: Arial, sans-serif;
  margin: 20px;
}

#calendar {
  max-width: 1200px;
  margin: auto;
}

.fc-event-title {
  font-weight: bold;
}

.fc-toolbar-title {
  font-size: 20px;
}
</style>
</head>

<body>

<h2>Friseur-Kalender (intern)</h2>

<div id="calendar"></div>

<script>
document.addEventListener("DOMContentLoaded", function () {

  const staffMembers = ["Herrmann", "Soner", "Gülcin", "Kadir"];

  const calendarEl = document.getElementById("calendar");

  const calendar = new FullCalendar.Calendar(calendarEl, {
    initialView: "timeGridWeek",
    locale: "de",
    editable: true,
    selectable: true,
    nowIndicator: true,
    slotMinTime: "08:00:00",
    slotMaxTime: "20:00:00",
    headerToolbar: {
      left: "prev,next today",
      center: "title",
      right: "timeGridDay,timeGridWeek"
    },

    events: loadEvents(),

    select: function (info) {
      const staff = prompt(
        "Mitarbeiter:\n" + staffMembers.join(", ")
      );
      if (!staffMembers.includes(staff)) {
        alert("Ungültiger Mitarbeiter");
        return;
      }

      const customer = prompt("Kundenname:");
      if (!customer) return;

      const service = prompt("Leistung:");
      if (!service) return;

      const event = {
        id: crypto.randomUUID(),
        title: `${staff} – ${customer} (${service})`,
        start: info.startStr,
        end: info.endStr,
        extendedProps: { staff, customer, service }
      };

      calendar.addEvent(event);
      saveEvents(calendar.getEvents());
    },

    eventClick: function (info) {
      if (!confirm("Termin löschen?")) return;
      info.event.remove();
      saveEvents(calendar.getEvents());
    },

    eventDrop: function () {
      saveEvents(calendar.getEvents());
    },

    eventResize: function () {
      saveEvents(calendar.getEvents());
    }
  });

  calendar.render();

  /* ====== LocalStorage ====== */

  function saveEvents(events) {
    const data = events.map(e => ({
      id: e.id,
      title: e.title,
      start: e.start,
      end: e.end,
      extendedProps: e.extendedProps
    }));
    localStorage.setItem("calendarEvents", JSON.stringify(data));
  }

  function loadEvents() {
    return JSON.parse(localStorage.getItem("calendarEvents") || "[]");
  }

});
</script>

</body>
</html>
